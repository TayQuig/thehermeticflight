---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogCard from '../components/BlogCard.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout 
  title="Flight Log | The Hermetic Flight"
  description="Insights on aerial arts, tarot divination, and embodied practice from The Hermetic Flight."
>
  <Header />
  
  <main class="relative z-10 pt-32 pb-20 px-6 sm:px-8 lg:px-12 max-w-6xl mx-auto">
    
    <!-- Page Header -->
    <header class="text-center mb-16 reveal-up">
      <p class="font-serif text-hermetic-sulfur text-sm tracking-[0.2em] uppercase mb-4 font-bold">
        Writings & Insights
      </p>
      <h1 class="font-serif text-4xl md:text-5xl text-white mb-6">
        The <span class="text-hermetic-gold">Flight Log</span>
      </h1>
      <p class="text-lg text-gray-300 max-w-2xl mx-auto leading-relaxed">
        Explorations at the intersection of aerial arts, tarot divination, and embodied transformation.
      </p>
    </header>

    <!-- Blog Grid -->
    {posts.length > 0 ? (
      <div class="grid md:grid-cols-2 gap-8">
        {posts.map((post) => (
          <div class="reveal-up">
            <BlogCard post={post} />
          </div>
        ))}
      </div>
    ) : (
      <div class="glass-panel rounded-2xl p-12 text-center">
        <p class="text-gray-400 font-sans">No posts yet. Check back soon for insights from The Hermetic Flight.</p>
      </div>
    )}
    
  </main>

  <Footer />

  <script>
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('reveal-visible');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.reveal-up').forEach((el) => observer.observe(el));
  </script>
</Layout>

